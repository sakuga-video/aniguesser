(this.webpackJsonpaniguesser=this.webpackJsonpaniguesser||[]).push([[0],{128:function(e,t,n){},134:function(e,t,n){"use strict";n.r(t),n.d(t,"dark_theme",(function(){return Ae}));var r=n(0),s=n.n(r),a=n(11),i=n.n(a),c=(n(95),n(14)),o=n(33),u=n(24),l=n(70),d=n.n(l),j=(n(128),n(177)),m=n(192),g=n(179),p=n(180),v=n(193),b=n(71),f=n(45),h={videos:[],guesses:[],index:0,guess_to_show:void 0,playing:!1,tags:[]},O=Object(f.b)({name:"app",initialState:h,reducers:{change_video:function(e,t){var n,r=t.payload,s=e.index,a=null===(n=e.guesses[s])||void 0===n?void 0:n.guess;e.guesses[s]={guess:a,answers:r.tags},e.videos[s]?e.videos[s].push(r):e.videos[s]=[r]},submit_guess:function(e){var t,n,r=e.guesses,s=e.index,a=e.videos[s];void 0!==a&&(e.guess_to_show=s,r[s]||(r[s]={answers:null!==(t=null===(n=a[a.length-1])||void 0===n?void 0:n.tags)&&void 0!==t?t:[]}))},show_next_tag:function(e){var t=e.index;t+1<ge.length?e.index=t+1:(e.index=0,e.playing=!1),e.guess_to_show=void 0},start:function(e,t){e.index=0,e.guesses=[],e.playing=!0,e.tags=t.payload},change_guess:function(e,t){var n,r,s=t.payload,a=e.index,i=e.videos[a];i&&(e.guesses[a]={guess:s,answers:null!==(n=null===(r=i[i.length-1])||void 0===r?void 0:r.tags)&&void 0!==n?n:[]})}}}),x=O.actions,_=x.change_video,w=x.show_next_tag,y=x.start,C=x.submit_guess,T=x.change_guess,A=O.reducer,E=n(172),N=n(176),S=n(73),k=n(5),R=function(e){var t=e.duration,n=e.size,s=e.type,a=e.on_time_over,i=e.interval,o=void 0===i?50:i,u=e.className,l=e.count_down,d=void 0!==l&&l,j=e.show_emergency_color,m=void 0!==j&&j,g=1e3*t/o,p=Object(S.useTimer)({endTime:g,interval:o,onTimeOver:a}),v=p.time,b=p.start,f=p.reset;Object(r.useEffect)((function(){return b(),f}),[f,b]);var h=function(e){return 100*(d?g-e:e)/g},O={color:h(v)<25&&m?"secondary":"primary",variant:"determinate",value:h(v),className:u};return"linear"===s?Object(k.jsx)(E.a,Object(c.a)({},O)):Object(k.jsx)(N.a,Object(c.a)({size:n},O))},I=Object(j.a)({wrapper:{position:"relative"},fabProgress:{position:"absolute",top:-6,left:-6}}),P={keys:[function(e){return e.name}],baseSort:function(e,t){return t.item.count-e.item.count}},F=function(e,t){var n=t.inputValue;return n?Object(b.a)(e,n,P).slice(0,100):[]},H=function(e){var t=e.all_tags,n=fe(),s=I(),a=Object(r.useState)(null),i=Object(o.a)(a,2),u=i[0],l=i[1];return Object(k.jsxs)("form",{id:"guess",onSubmit:function(e){e.preventDefault(),u&&n(C())},children:[Object(k.jsx)("div",{id:"guess-input",children:Object(k.jsx)(v.a,{selectOnFocus:!0,clearOnBlur:!0,autoHighlight:!0,autoComplete:!0,disableClearable:!0,clearOnEscape:!0,options:t,style:{width:300},filterOptions:F,getOptionLabel:function(e){return e.name},onChange:function(e,t){var r;l(t),n(T(null!==(r=null===t||void 0===t?void 0:t.name)&&void 0!==r?r:""))},renderInput:function(e){return Object(k.jsx)(m.a,Object(c.a)(Object(c.a)({},e),{},{label:"Guess the title",variant:"filled",autoFocus:!0}))}})}),Object(k.jsxs)("div",{className:s.wrapper,children:[Object(k.jsx)(R,{size:68,duration:30,on_time_over:function(){return n(C())},count_down:!0,show_emergency_color:!0,className:s.fabProgress}),Object(k.jsx)(g.a,{type:"submit","area-label":"submit",children:Object(k.jsx)(p.a,{})})]})]})},B=n(35),G=n.n(B),L=n(55);function z(){return(z=Object(L.a)(G.a.mark((function e(){var t,n;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/tag.json?limit=0&order=count&type="+J.COPYRIGHT);case 2:return t=e.sent,e.next=5,t.json();case 5:return n=e.sent.map(M),e.abrupt("return",n.filter((function(e){return e.count>0})));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(e){return D.apply(this,arguments)}function D(){return(D=Object(L.a)(G.a.mark((function e(t){var n,r,s;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="/api/post.json?limit=1&tags=rating:safe order:random ext:mp4,webm "+t.name.replaceAll(" ","_"),e.next=3,fetch(n);case 3:return r=e.sent,e.next=6,r.json();case 6:return s=e.sent[0],e.abrupt("return",s);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var J,M=function(e){return{count:e.count,id:e.id,name:e.name.replaceAll("_"," ")}},V=function(e){var t=e.tag,n=e.video,s=e.video_wrapper,a=fe();Object(r.useEffect)((function(){var e=!0;return Y(t).then(s.wrap).then((function(t){e&&a(_(t))})),function(){e=!1}}),[t,s,a]);var i=function(e){a(_(e))};return Object(k.jsx)("video",{muted:!0,preload:"auto",autoPlay:!0,src:null===n||void 0===n?void 0:n.url,onEnded:function(){Y(t).then(s.wrap).then(i)}})},q=n(188),K=n(80),Q=n(135),U=Object(j.a)({timer:{width:"100%"},root:{flexBasis:"400px"}}),W=function(e){return e.length>0?Object(k.jsxs)("p",{children:["it was ",Object(K.sortBy)(e,(function(e){return e.count}))[e.length-1].name]}):null},X=function(e){var t=e.guess,n=e.answers,r=e.closest_answer,s=e.result,a=e.is_exact,i=fe(),c=U(),o=Object(k.jsx)(R,{duration:4,on_time_over:function(){return i(w())},type:"linear",className:c.timer});return Object(k.jsxs)(Q.a,{id:"guess-result",className:c.root,children:["missing"!==s&&Object(k.jsx)("p",{children:t}),"correct"===s&&!a&&Object(k.jsxs)("p",{children:["(",r,")"]}),Object(k.jsx)("h1",{children:{correct:"\ud83c\udf89 is correct \ud83c\udf8a",incorrect:"is incorrect",missing:"No guess"}[s]}),"correct"!==s&&W(n),o]})},Z=function(e){var t=e.score,n=e.max_score;return Object(k.jsxs)("p",{id:"score",className:"controls",children:["Correct: ",t,"/",n]})},$=n(83),ee=function(e){var t,n;if(!e.guess)return{result:"missing",is_exact:!1};var r=new $.a(e.answers.map((function(e){return e.name})),{includeScore:!0,threshold:.1}).search(e.guess);return{result:r.length>0?"correct":"incorrect",is_exact:0===(null===(t=r[0])||void 0===t?void 0:t.score),closest_answer:null===(n=r[0])||void 0===n?void 0:n.item}},te=n(13),ne=n(81),re=function e(t){var n=this;Object(te.a)(this,e),this.tags_by_name=void 0,this.wrap=function(e){return{tags:e.tags.split(" ").map((function(e){return e.replaceAll("_"," ")})).map((function(e){return n.tags_by_name.get(e)})).filter((function(e){return void 0!==e})),url:e.file_url,id:e.id,preview_url:e.preview_url}},this.tags_by_name=Object(ne.a)(t.map((function(e){return[e.name,e]})))},se=n(181),ae=n(182),ie=n(183),ce=n(184),oe=n(185),ue=n(186),le=n(187),de=function(e){var t=ee(e),n='"'+e.guess+'" ';return{missing:"No guess",correct:n+"\ud83c\udf89 was correct \ud83c\udf8a",incorrect:n+"was incorrect"}[t.result]},je=Object(j.a)({root:{minHeight:250}}),me=function(e){var t=e.rounds,n=e.all_tags,r=fe(),s=je();return Object(k.jsxs)(le.a,{children:[Object(k.jsx)(se.a,{container:!0,spacing:2,children:t.map((function(e,t){return Object(k.jsx)(se.a,{item:!0,className:"round-summary",xs:12,sm:6,md:4,children:Object(k.jsx)(ae.a,{classes:s,children:Object(k.jsxs)(ie.a,{href:"https://www.sakugabooru.com/post?tags="+e.tag.name.replaceAll(" ","_"),target:"_blank",children:[Object(k.jsx)(ce.a,{component:"img",title:"Image thumbnail of a clip from "+e.videos[0].tags[0].name,alt:"Image thumbnail of a clip from "+e.videos[0].tags[0].name,image:e.videos[0].preview_url}),Object(k.jsxs)(oe.a,{children:[Object(k.jsx)(ue.a,{gutterBottom:!0,variant:"h5",component:"h2",children:e.tag.name}),Object(k.jsx)(ue.a,{variant:"body2",component:"p",children:de(e.guess)})]})]})})},t)}))}),Object(k.jsx)("div",{id:"play-again",children:Object(k.jsx)(q.a,{variant:"contained",onClick:function(){return r(y(pe(n)))},color:"primary",children:"Play Again"})})]})};!function(e){e[e.GENERAL=0]="GENERAL",e[e.ARTIST=1]="ARTIST",e[e.COPYRIGHT=3]="COPYRIGHT",e[e.CHARACTER=4]="CHARACTER"}(J||(J={}));var ge=[{max:1e5,min:500},{max:1e5,min:500},{max:1e5,min:500},{max:500,min:100},{max:500,min:100},{max:500,min:100},{max:500,min:100},{max:500,min:100},{max:100,min:25},{max:25,min:1},{max:25,min:1},{max:1,min:1}];function pe(e){return ge.map((function(t){var n=t.max,r=t.min;return d()(e.filter((function(e){var t=e.count;return n>=t&&t>=r})))}))}function ve(e,t){return void 0!==t?e+1:e}function be(e,t){for(var n=0,r=0;r<t;r++)"correct"===ee(e[r]).result&&(n+=1);return n}var fe=function(){return Object(u.b)()};var he=function(){var e=Object(u.c)((function(e){return e.app})),t=e.guesses,n=e.index,a=e.videos,i=e.guess_to_show,l=e.playing,d=e.tags,j=Object(u.c)((function(e){for(var t=e.app,n=t.tags.length,r=[],s=0;s<n;s++)r.push({tag:t.tags[s],videos:t.videos[s],guess:t.guesses[s]});return r})),m=Object(u.c)((function(e){var t=e.app.guess_to_show;return void 0===t?void 0:ee(e.app.guesses[t])})),g=fe(),p=Object(r.useState)([]),v=Object(o.a)(p,2),b=v[0],f=v[1],h=Object(r.useState)(void 0),O=Object(o.a)(h,2),x=O[0],_=O[1];return Object(r.useEffect)((function(){(function(){return z.apply(this,arguments)})().then((function(e){f(e),_(new re(e))}))}),[]),!l&&t.length>0?Object(k.jsx)(me,{rounds:j,all_tags:b}):Object(k.jsxs)("div",{id:"game",children:[l&&Object(k.jsx)(Z,{score:be(t,ve(n,i)),max_score:ve(n,i)}),0===b.length&&Object(k.jsx)(R,{duration:.8}),!l&&0===t.length&&b.length>0&&Object(k.jsx)(q.a,{variant:"contained",disabled:0===b.length,onClick:function(){return g(y(pe(b)))},id:"start",children:"Start"}),l&&d.length>0&&void 0===i&&x&&Object(k.jsxs)(s.a.Fragment,{children:[Object(k.jsx)(V,{tag:d[n],video:a[n]?a[n][a[n].length-1]:void 0,video_wrapper:x}),a[n]&&Object(k.jsx)(H,{all_tags:b})]}),void 0!==i&&void 0!==m&&Object(k.jsx)(X,Object(c.a)(Object(c.a)({},m),t[i]))]})},Oe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,194)).then((function(t){var n=t.getCLS,r=t.getFID,s=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),r(e),s(e),a(e),i(e)}))},xe=n(190),_e=n(82),we=n(189),ye=n(47),Ce=Object(f.a)({reducer:{app:A}}),Te=n(191),Ae=Object(_e.a)({palette:{type:"dark",primary:we.a,secondary:ye.a}});i.a.render(Object(k.jsx)(s.a.StrictMode,{children:Object(k.jsxs)(xe.a,{theme:Ae,children:[Object(k.jsx)(Te.a,{}),Object(k.jsx)(u.a,{store:Ce,children:Object(k.jsx)(he,{})})]})}),document.getElementById("root")),Oe()},95:function(e,t,n){}},[[134,1,2]]]);
//# sourceMappingURL=main.d3dd2b3a.chunk.js.map