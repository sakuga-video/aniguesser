{"version":3,"sources":["GameDatabase.ts","appSlice.ts","Timer.tsx","GuessInput.tsx","SakugaAPI.tsx","VideoPlayer.tsx","GuessResultUI.tsx","GuessMatcher.ts","VideoWrapper.ts","StartButton.tsx","App.tsx","historySlice.ts","Navigation.tsx","RoundSummary.tsx","RoundSummaries.tsx","PagedRoundSummaries.tsx","RoundDetails.tsx","RoundDetailsLoader.tsx","History.tsx","GameSummary.tsx","Progress.tsx","reportWebVitals.ts","app/store.ts","dark_theme.ts","index.tsx"],"names":["database","database_name","rounds","version","stores","table","Dexie","initialState","videos","guesses","index","guess_to_show","undefined","playing","tags","appSlice","createSlice","name","reducers","mark_played","state","action","video_index","payload","tag_index","guess","playing_video","answers","played","set_videos","submit_guess","length","stop_showing_guess_results","start","change_guess","skip_tag","splice","actions","save_and_submit_guess","time_to_guess","dispatch","getState","app","tag","put","date","Date","now","filter","video","then","catch","console","log","Timer","duration","size","type","on_time_over","interval","className","count_down","show_emergency_color","adjusted_duration","useTimer","endTime","onTimeOver","time","reset","useEffect","normalize","value","progress_props","color","variant","LinearProgress","CircularProgress","useStyles","makeStyles","wrapper","position","fabProgress","top","left","match_sorter_options","keys","baseSort","tag_a","tag_b","item","count","filter_options","options","inputValue","matchSorter","slice","GuessInput","all_tags","useThunkDispatch","classes","useState","set_guess","id","onSubmit","event","preventDefault","Autocomplete","selectOnFocus","clearOnBlur","autoHighlight","autoComplete","disableClearable","clearOnEscape","style","width","filterOptions","getOptionLabel","onChange","_","renderInput","params","TextField","label","autoFocus","Fab","area-label","Send","a","fetch","API_URL","TagType","COPYRIGHT","response","json","map","map_tag","limit","url","split","join","jsonTag","increment","max","VideoPlayer","video_wrapper","should_play","loading","set_loading","set_index","mounted","fetch_random_videos","video_responses","wrap","play_next_video","new_index","Fragment","muted","onBuffer","onStart","onPlay","loop","onError","visibility","controls","height","onEnded","timer","root","display","flexDirection","justifyContent","alignItems","answer_ui","Typography","sortBy","GuessResultUI","closest_answer","result","is_exact","Paper","Container","component","correct","incorrect","missing","Matches","search_results","Fuse","includeScore","threshold","search","score","VideoWrapper","tags_by_name","video_response","tag_string","get","file_url","preview_url","this","Map","choose_random_tags","POPULARITY_LIST","min","sample","StartButton","Button","onClick","historySlice","page","num_rounds","set_rounds","set_num_rounds","set_active_round","active_round","load_num_rounds","load_rounds","page_size","orderBy","reverse","offset","toArray","zIndex","bottom","marginTop","Navigation","pathname","window","location","setValue","Box","BottomNavigation","newValue","showLabels","BottomNavigationAction","icon","SportsEsports","Link","to","Restore","tag_url","theme","title","textOverflow","overflow","whiteSpace","media","textDecoration","palette","text","primary","render_guess","guess_string","RoundSummary","round","last_video","title_tag","Card","CardActionArea","CardMedia","alt","image","CardContent","gutterBottom","RoundSummaries","Grid","container","spacing","xs","sm","md","pagination","margin","PagedRoundSummaries","useSelector","history","Pagination","Math","ceil","tag_wrapper","flexWrap","get_guess","RoundDetails","IconButton","href","toDateString","rarest_tag","tags_minus_main","src","poster","Chip","clickable","CardActions","download","SaveAlt","RoundDetailsLoader","round_id","where","equals","first","load_round_details","paddingBottom","History","useParams","parseInt","useContainerStyles","GameSummary","container_classes","align","useProgressStepIconStyles","background","default","active","circle","borderRadius","border","backgroundColor","completed","secondary","main","fontSize","ProgressStepIcon","props","progressClass","clsx","progressStyles","padding","transform","ProgressConnector","withStyles","StepConnector","Progress","activeStep","steps","CorrectIcon","IncorrectIcon","Stepper","connector","is_correct","guess_matches","Step","StepLabel","StepIconComponent","useDispatch","App","number_of_rounds","i","push","match_result","set_all_tags","set_video_wrapper","fetch_all_tags","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","store","configureStore","reducer","appReducer","historyReducer","createMuiTheme","lightBlue","red","ReactDOM","render","StrictMode","ThemeProvider","dark_theme","CssBaseline","path","document","getElementById"],"mappings":"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","file":"static/js/main.72477f4f.chunk.js","sourcesContent":["import Dexie from 'dexie';\nimport { Tag } from './App';\nimport { Video } from './VideoWrapper';\n\nclass GameDatabase extends Dexie {\n    rounds: Dexie.Table<Round, number>;\n\n    constructor(database_name: string) {\n        super(database_name);\n        this.version(1).stores({\n            rounds: '++id,date,guess,videos,time_to_guess,tag'\n        });\n        this.rounds = this.table('rounds');\n    }\n}\n\nexport interface Round {\n    id?: number,\n    date: number,\n    guess?: string,\n    videos: Video[],\n    time_to_guess: number,\n    tag: Tag,\n}\n\nconst database = new GameDatabase(\"aniguesser\");\n\nexport default database;","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport { Tag } from './App';\nimport { Guess } from './GuessMatcher';\nimport { Video } from './VideoWrapper';\nimport { AppThunk } from './app/store';\nimport database from './GameDatabase';\n\ninterface AppState {\n  readonly videos: Video[][],\n  readonly guesses: Guess[],\n  readonly index: number,\n  readonly guess_to_show: number | undefined,\n  readonly playing: boolean,\n  readonly tags: Tag[],\n}\n\nconst initialState: AppState = {\n  videos: [],\n  guesses: [],\n  index: 0,\n  guess_to_show: undefined,\n  playing: false,\n  tags: [],\n};\n\nexport const appSlice = createSlice({\n  name: 'app',\n  initialState,\n  reducers: {\n    mark_played: (state, action: PayloadAction<number>) => {\n      const video_index = action.payload;\n      const tag_index = state.index;\n      const guess = state.guesses[tag_index]?.guess;\n      const videos = state.videos[tag_index];\n      const playing_video = videos[video_index];\n\n      state.guesses[tag_index] = { guess, answers: playing_video.tags };\n      playing_video.played = true;\n    },\n    set_videos: (state, action: PayloadAction<Video[]>) => {\n      state.videos[state.index] = action.payload;\n    },\n    submit_guess: (state, action: PayloadAction<Guess>) => {\n      const index = state.index;\n\n      // show current guess\n      state.guess_to_show = index;\n      state.guesses[index] = action.payload;\n\n      // advance to next tag in the background,\n      // so we can preload the next video\n      if ((index + 1) < state.tags.length) {\n        state.index = index + 1;\n      } else {\n        state.playing = false;\n      }\n    },\n    stop_showing_guess_results: state => {\n      state.guess_to_show = undefined;\n    },\n    start: (state, action: PayloadAction<Tag[]>) => {\n      state.index = 0;\n      state.guess_to_show = undefined;\n      state.guesses = [];\n      state.videos = [];\n      state.playing = true;\n      state.tags = action.payload;\n    },\n    change_guess: (state, action: PayloadAction<string>) => {\n      const guess = action.payload;\n      const index = state.index;\n      const videos = state.videos[index];\n      if (videos) {\n        state.guesses[index] = {\n          guess,\n          answers: videos[videos.length - 1]?.tags ?? []\n        };\n      }\n    },\n    skip_tag: state => {\n      state.tags.splice(state.index, 1);\n      if ((state.index) >= state.tags.length) {\n        state.index = 0;\n        state.playing = false;\n      }\n    },\n  },\n});\n\nexport const {\n  mark_played,\n  stop_showing_guess_results,\n  start,\n  submit_guess,\n  change_guess,\n  skip_tag,\n  set_videos,\n} = appSlice.actions;\n\nexport const save_and_submit_guess = (time_to_guess: number): AppThunk => (dispatch, getState) => {\n  const state = getState().app;\n  const guesses = state.guesses;\n  const index = state.index;\n  const videos = state.videos[index];\n  const tag = state.tags[index];\n\n  // someone tried to submit a guess before\n  // the video loaded. just ignore it\n  if (videos === undefined || !videos[0]?.played) {\n    return;\n  }\n\n  // video timed out. submit an empty guess\n  let guess = guesses[index];\n  if (!guess) {\n    guess = {\n      answers: videos[videos.length - 1]?.tags ?? [],\n    };\n  }\n\n  database.rounds.put({\n    date: Date.now(),\n    guess: guess.guess,\n    videos: videos.filter(video => video.played),\n    time_to_guess,\n    tag,\n  })\n  .then(() => dispatch(submit_guess(guess)))\n  .catch(console.log);\n};\n\nexport default appSlice.reducer;\n","import { CircularProgress, CircularProgressProps, LinearProgress, LinearProgressProps } from \"@material-ui/core\"\nimport { useEffect } from \"react\";\nimport { useTimer } from \"use-timer\";\n\ntype Props = {\n    duration: number,\n    size?: number,\n    type?: \"linear\" | \"circular\",\n    on_time_over?: () => void,\n    className?: string,\n    interval?: number,\n    count_down?: boolean,\n    show_emergency_color?: boolean,\n}\n\nconst Timer = ({\n    duration,\n    size,\n    type,\n    on_time_over,\n    interval=50,\n    className,\n    count_down=false,\n    show_emergency_color=false,\n}: Props) => {\n    const adjusted_duration = duration * 1000 / interval;\n    const { time, start, reset } = useTimer({\n        endTime: adjusted_duration,\n        interval,\n        onTimeOver: on_time_over,\n    });\n\n    useEffect(() => {\n        start();\n        return reset;\n    }, [reset, start]);\n\n    const normalize = (value: number) => {\n        const adjusted_value = count_down ? adjusted_duration - value : value;\n        return adjusted_value * 100 / adjusted_duration;\n    }\n\n    const progress_props = {\n        color: normalize(time) < 25 && show_emergency_color ? \"secondary\" : \"primary\",\n        variant: \"determinate\",\n        value: normalize(time),\n        className,\n    };\n\n    return type === \"linear\" ?\n        <LinearProgress {...progress_props as LinearProgressProps} />:\n        <CircularProgress size={size} {...progress_props as CircularProgressProps} />\n}\n\nexport default Timer;","import { Fab, makeStyles, TextField } from '@material-ui/core';\nimport { Send } from '@material-ui/icons';\nimport { Autocomplete } from '@material-ui/lab';\nimport { ChangeEvent, FormEvent, useState } from 'react';\nimport { Tag, useThunkDispatch } from './App';\nimport { matchSorter, MatchSorterOptions } from 'match-sorter';\nimport { change_guess, save_and_submit_guess } from './appSlice';\nimport Timer from './Timer';\n\nconst TAG_TIMER_DURATION = 30;\nconst useStyles = makeStyles({\n    wrapper: {\n      position: 'relative',\n    },\n    fabProgress: {\n      position: 'absolute',\n      top: -6,\n      left: -6,\n    },\n});\n\nconst GuessInput = ({ all_tags }: { all_tags: Tag[] }) => {\n  const dispatch = useThunkDispatch();\n  const classes = useStyles();\n  const [guess, set_guess] = useState<Tag | null>(null);\n\n  const on_guess_change = (_: ChangeEvent<{}>, value: Tag | null) => {\n    set_guess(value);\n    dispatch(change_guess(value?.name ?? \"\"));\n  }\n\n  const on_form_submitted = (event: FormEvent<HTMLFormElement>) => {\n    event.preventDefault();\n    if (guess) {\n      dispatch(save_and_submit_guess(0));\n    }\n  }\n\n  return (\n    <form id=\"guess\" onSubmit={on_form_submitted}>\n      <div id=\"guess-input\">\n        <Autocomplete\n          selectOnFocus\n          clearOnBlur\n          autoHighlight\n          autoComplete\n          disableClearable\n          clearOnEscape\n          options={all_tags}\n          style={{ width: 300 }}\n          filterOptions={filter_options}\n          getOptionLabel={tag => tag.name}\n          onChange={on_guess_change}\n          renderInput={(params) => <TextField {...params} label=\"Guess the title\" variant=\"filled\" autoFocus />}\n        />\n      </div>\n      <div className={classes.wrapper}>\n        <Timer\n          size={68}\n          duration={TAG_TIMER_DURATION}\n          on_time_over={() => dispatch(save_and_submit_guess(TAG_TIMER_DURATION))}\n          count_down={true}\n          show_emergency_color={true}\n          className={classes.fabProgress}\n        />\n        <Fab type=\"submit\" area-label=\"submit\">\n          <Send />\n        </Fab>\n      </div>\n    </form>\n  );\n};\n\nconst match_sorter_options: MatchSorterOptions<Tag> = {\n  keys: [tag => tag.name],\n  baseSort: (tag_a, tag_b) => tag_b.item.count - tag_a.item.count,\n};\n\nconst filter_options = (options: Tag[], { inputValue }: { inputValue: string}) =>\n  inputValue ? matchSorter(options, inputValue, match_sorter_options).slice(0, 100) : [];\n  \nexport default GuessInput;","import { Tag, TagType } from \"./App\";\n\nconst API_URL = \"/api/\";\n\nexport type VideoResponse = {\n    file_url: string,\n    id: number,\n    tags: string,\n    preview_url: string,\n};\n\nexport async function fetch_all_tags() {\n    const response = await fetch(API_URL+'tag.json?limit=0&order=count&type='+TagType.COPYRIGHT);\n    const tags: Tag[] = (await response.json()).map(map_tag);\n    return tags.filter(({ count }) => count > 0);\n}\n\nexport async function fetch_random_videos(tag: Tag, limit = 8): Promise<VideoResponse[]> {\n    const url = API_URL+'post.json?tags=rating:safe order:random ext:mp4,webm ' + tag.name.split(\" \").join(\"_\") + \"&limit=\" + limit;\n    const response = await fetch(url);\n    return await response.json();\n}\n\nconst map_tag = (jsonTag: any): Tag => ({\n    count: jsonTag.count,\n    id: jsonTag.id,\n    name: jsonTag.name.split(\"_\").join(\" \"),\n});","import { CircularProgress } from \"@material-ui/core\";\nimport React, { useEffect, useState } from \"react\";\nimport ReactPlayer from \"react-player\";\nimport { Tag, useThunkDispatch } from \"./App\";\nimport { mark_played, set_videos, skip_tag } from \"./appSlice\";\nimport { fetch_random_videos } from \"./SakugaAPI\";\nimport VideoWrapper, { Video } from \"./VideoWrapper\";\n\ntype Props = {\n    tag: Tag,\n    videos: Video[],\n    video_wrapper: VideoWrapper,\n    should_play: boolean,\n};\n\nconst increment = (index: number, max: number) => (index + 1) % max;\n\nconst VideoPlayer = ({ tag, videos, video_wrapper, should_play }: Props) => {\n    const dispatch = useThunkDispatch();\n    const [loading, set_loading] = useState(true);\n    const [index, set_index] = useState(0);\n\n    useEffect(() => {\n        let mounted = true;\n        set_index(0);\n        fetch_random_videos(tag)\n            .then(video_responses => video_responses.map(video_wrapper.wrap))\n            .then(videos => {\n                if (mounted) {\n                    if (videos.length > 0) {\n                        set_index(0);\n                        dispatch(set_videos(videos));\n                    } else {\n                        dispatch(skip_tag());\n                    }\n                }\n            })\n        return () => { mounted = false }; \n    }, [tag, video_wrapper, dispatch]);\n\n    const play_next_video = () => {\n        if (videos.length > 1) {\n            const new_index = increment(index, videos.length);\n            set_index(new_index);\n        }\n    }\n\n    return (\n        <React.Fragment>\n        {(videos.length === 0 || loading) && should_play && <CircularProgress className=\"video-loading\" />}\n        <ReactPlayer\n            key={index}\n            muted\n            onBuffer={() => set_loading(true)}\n            onStart={() => {dispatch(mark_played(index)); set_loading(false);}}\n            onPlay={() => set_loading(false)}\n            playing={should_play}\n            loop={videos.length === 1}\n            onError={play_next_video}\n            url={videos[index]?.url}\n            style={should_play ? {visibility: \"visible\"} : {}}\n            className={should_play ? \"active\": \"\"}\n            id=\"main-video\"\n            controls={false}\n            width=\"100%\"\n            height=\"auto\"\n            onEnded={() => {play_next_video()}}\n        />\n\n        {\n            videos.length > 1 &&\n            <ReactPlayer\n                key={increment(index, videos.length)}\n                muted\n                id=\"preloading-video\"\n                url={videos[increment(index, videos.length)]?.url}\n            />\n        }\n        </React.Fragment>\n    );\n\n}\n\nexport default VideoPlayer;","import { Tag, useThunkDispatch } from './App';\nimport { sortBy } from 'lodash';\nimport Timer from './Timer';\nimport { stop_showing_guess_results } from './appSlice';\nimport { Container, makeStyles, Paper, Typography } from '@material-ui/core';\nimport { MatchResult } from './GuessMatcher';\nimport React from 'react';\n\nconst RESULT_DISPLAY_DURATION = 4;\n\nconst useStyles = makeStyles({\n    timer: {\n      width: \"100%\",\n    },\n    root: {\n        width:400,\n        height:200,\n        display: \"flex\",\n        flexDirection: \"column\",\n        justifyContent: \"space-evenly\",\n        alignItems: \"center\",\n    },\n});\n\nexport type GuessResult = \"correct\" | \"missing\" | \"incorrect\";\n\nexport interface GuessResultUIProps extends MatchResult {\n    readonly guess?: string,\n    readonly answers: Tag[],\n}\n\nconst GuessResultUI = ({guess, answers, closest_answer, result, is_exact}: GuessResultUIProps) => {\n    const dispatch = useThunkDispatch();\n    const classes = useStyles();\n\n    const timer = (\n        <Timer\n            duration={RESULT_DISPLAY_DURATION}\n            on_time_over={() => dispatch(stop_showing_guess_results())}\n            type = \"linear\"\n            className={classes.timer}\n        />\n    );\n    return (\n        <Paper>\n            <Container className={classes.root}>\n                {result !== \"missing\" && <Typography variant=\"body1\">{guess}</Typography>}\n                {result === \"correct\" && !is_exact && <Typography variant=\"body1\">({closest_answer})</Typography> }\n                <Typography variant=\"h3\" component=\"p\">{{\n                    correct: \"🎉 is correct 🎊\",\n                    incorrect: \"is incorrect\",\n                    missing: \"No guess\",\n                }[result]}</Typography>\n                {result !== \"correct\" && answer_ui(answers)}\n            </Container>\n            {timer}\n        </Paper>\n    )\n}\n\nconst answer_ui = (answers: Tag[]) => {\n    if (answers.length > 0) {\n        return <Typography variant=\"body1\">it was {sortBy(answers, tag => tag.count)[answers.length - 1].name}</Typography>\n    } else {\n        return null;\n    }\n}\n\nexport default GuessResultUI;","import Fuse from \"fuse.js\";\nimport { Tag } from \"./App\";\nimport { GuessResult } from \"./GuessResultUI\";\n\nexport type MatchResult = {\n    readonly result: GuessResult,\n    readonly is_exact: boolean,\n    readonly closest_answer?: string,\n}\n\nconst Matches = (guess: Guess): MatchResult => {\n    if (!guess.guess) {\n        return {\n            result: \"missing\",\n            is_exact: false,\n        };\n    }\n    const options = {\n        includeScore: true,\n        threshold: 0.1,\n    };\n    const fuse = new Fuse(guess.answers.map(tag => tag.name), options);\n    const search_results = fuse.search(guess.guess);\n    return {\n        result: search_results.length > 0 ? \"correct\" : \"incorrect\",\n        is_exact: search_results[0]?.score === 0,\n        closest_answer: search_results[0]?.item,\n    }\n}\n\nexport type Guess = {\n    readonly answers: Tag[],\n    readonly guess?: string,\n}\n\nexport default Matches;","import { Tag } from \"./App\";\nimport { VideoResponse } from \"./SakugaAPI\";\nimport { Map } from \"immutable\";\n\nclass VideoWrapper {\n    readonly tags_by_name: Map<string, Tag>;\n\n    constructor(all_tags: Tag[]) {\n        this.tags_by_name = Map(all_tags.map(tag => [tag.name, tag]));\n    }\n\n    readonly wrap = (video_response: VideoResponse): Video => {\n        const tags = video_response.tags\n            .split(\" \")\n            .map(tag_string => tag_string.split(\"_\").join(\" \"))\n            .map(tag_string => this.tags_by_name.get(tag_string))\n            .filter(tag => tag !== undefined) as Tag[];\n\n        return {\n            tags,\n            url: video_response.file_url,\n            id: video_response.id,\n            preview_url: video_response.preview_url,\n        }\n    }\n}\n\nexport type Video = {\n    readonly url: string,\n    readonly id: number,\n    readonly tags: Tag[],\n    readonly preview_url: string,\n    readonly played?: boolean,\n};\n\nexport default VideoWrapper;","import { Button, CircularProgress } from \"@material-ui/core\";\nimport React from \"react\";\nimport sample from 'lodash/sample';\nimport { useThunkDispatch, Tag } from \"./App\";\nimport { start } from './appSlice';\n\nconst StartButton = ({ all_tags }: { all_tags: Tag[] }) => {\n\n    const dispatch = useThunkDispatch();\n    const is_ready = all_tags.length > 0;\n\n    return is_ready ?\n        <Button\n            variant=\"contained\"\n            onClick={() => dispatch(start(choose_random_tags(all_tags)))}\n            id=\"start\">\n            Start\n        </Button> :\n        <CircularProgress />\n}\n\nexport function choose_random_tags(tags: Tag[]): Tag[] {\n    return POPULARITY_LIST.map(({ max, min }) =>\n        sample(tags.filter(({ count }) => max >= count && count >= min))\n    ) as Tag[];\n}\n\ntype Popularity = { \"max\": number, \"min\": number };\n\nexport const POPULARITY_LIST: Popularity[] = [\n  { \"max\": 100000, \"min\": 500 },\n  { \"max\": 100000, \"min\": 500 },\n  { \"max\": 100000, \"min\": 500 },\n  { \"max\": 500, \"min\": 100 },\n  { \"max\": 500, \"min\": 100 },\n  { \"max\": 500, \"min\": 100 },\n  { \"max\": 500, \"min\": 100 },\n  { \"max\": 500, \"min\": 100 },\n  { \"max\": 100, \"min\": 25 },\n  { \"max\": 25, \"min\": 1 },\n  { \"max\": 25, \"min\": 1 },\n  { \"max\": 1, \"min\": 1 },\n];\n\nexport default StartButton;","import React, { useEffect, useState } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport './App.css';\nimport GuessInput from './GuessInput';\nimport VideoPlayer from './VideoPlayer';\nimport GuessResultUI from './GuessResultUI';\nimport guess_matches from './GuessMatcher';\nimport { fetch_all_tags } from './SakugaAPI';\nimport VideoWrapper from './VideoWrapper';\nimport { RootState, store } from './app/store';\nimport GameSummary from './GameSummary';\nimport Progress from './Progress';\nimport StartButton from './StartButton';\nimport Navigation from './Navigation';\nimport { Round } from './GameDatabase';\n\nexport enum TagType {\n  GENERAL = 0,\n  ARTIST = 1,\n  COPYRIGHT = 3,\n  CHARACTER = 4,\n}\n\nexport type Tag = {\n  readonly count: number,\n  readonly id: number,\n  readonly name: string,\n};\n\nexport const useThunkDispatch = () => useDispatch<typeof store.dispatch>();\n\nfunction App() {\n  const {\n    guesses,\n    index,\n    videos,\n    guess_to_show,\n    playing,\n    tags,\n  } = useSelector((state: RootState) => state.app);\n  const rounds: Round[] = useSelector((state: RootState) => {\n    const app = state.app;\n    const number_of_rounds = app.tags.length;\n    const rounds = [];\n    for (let i = 0; i < number_of_rounds; i++) {\n      rounds.push({\n        tag: app.tags[i],\n        videos: app.videos[i]?.filter(video => video.played),\n        guess: app.guesses[i]?.guess,\n        date: Date.now(),\n        time_to_guess: 0,\n      });\n    }\n    return rounds;\n  });\n  const match_result = useSelector((state: RootState) => {\n    const guess_to_show = state.app.guess_to_show;\n    return guess_to_show === undefined ?\n      undefined :\n      guess_matches(state.app.guesses[guess_to_show]!);\n  });\n\n  const [all_tags, set_all_tags] = useState<Tag[]>([]);\n  const [video_wrapper, set_video_wrapper] = useState<VideoWrapper | undefined>(undefined);\n\n  useEffect(() => {\n    fetch_all_tags().then(tags => {\n      set_all_tags(tags);\n      set_video_wrapper(new VideoWrapper(tags));\n    });\n  }, []);\n\n  if (!playing && guesses.length > 0 && guess_to_show === undefined) {\n    return (\n      <React.Fragment>\n        <GameSummary rounds={rounds} all_tags={all_tags} />\n        <Navigation />\n      </React.Fragment>\n    );\n  }\n\n  return (\n    <div id=\"game\">\n      {\n        !playing &&\n        guesses.length === 0 &&\n        <React.Fragment>\n          <StartButton all_tags={all_tags} />\n          <Navigation />\n        </React.Fragment>\n      }\n      {\n        playing && tags.length > 0 && video_wrapper &&\n        <React.Fragment>\n          <VideoPlayer\n            tag={tags[index]}\n            videos={videos[index] ?? []}\n            video_wrapper={video_wrapper}\n            should_play={guess_to_show === undefined}\n          />\n\n          {guess_to_show === undefined && videos[index] && <GuessInput all_tags={all_tags} />}\n        </React.Fragment>\n      }\n      {\n        (playing || index > 0) && tags.length > 0 &&\n        <Progress activeStep={index} steps={tags.map(tag => tag.name)} guesses={guesses} />\n      }\n      {\n        guess_to_show !== undefined &&\n        match_result !== undefined &&\n        <GuessResultUI\n          {...match_result}\n          {...guesses[guess_to_show]}\n        />\n      }\n    </div>\n  );\n}\n\nexport default App;\n","import database from './GameDatabase';\nimport { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\nimport { AppThunk } from \"./app/store\";\nimport { Round } from \"./GameDatabase\";\n\ninterface HistoryState {\n    readonly rounds: Round[],\n    readonly page: number,\n    readonly num_rounds: number,\n    readonly active_round?: Round,\n}\n\nconst initialState: HistoryState = {\n    rounds: [],\n    page: 0,\n    num_rounds: 0,\n}\n\nexport const historySlice = createSlice({\n    name: 'history',\n    initialState,\n    reducers: {\n        set_rounds: (state, action: PayloadAction<{page: number, rounds: Round[]}>) => {\n            state.rounds = action.payload.rounds;\n            state.page = action.payload.page;\n        },\n        set_num_rounds: (state, action: PayloadAction<number>) => {\n            state.num_rounds = action.payload;\n        },\n        set_active_round: (state, action: PayloadAction<Round | undefined>) => {\n            state.active_round = action.payload;\n        }\n    }\n});\n\nexport const {\n    set_rounds,\n    set_num_rounds,\n    set_active_round,\n} = historySlice.actions;\n\nexport const load_num_rounds = (): AppThunk => dispatch => {\n    database.rounds.count()\n        .then(count => dispatch(set_num_rounds(count)));\n}\n\ntype Page = { page: number, page_size: number };\n\nexport const load_rounds =\n    ({ page, page_size }: Page): AppThunk =>\n    dispatch => {\n        database.rounds\n            .orderBy(\"date\")\n            .reverse()\n            .offset(page * page_size)\n            .limit(page_size)\n            .toArray()\n            .then(rounds => dispatch(set_rounds({page, rounds})));\n    }\n\nexport const load_round_details =\n    (round_id: number): AppThunk =>\n    dispatch => {\n        database.rounds\n            .where(\":id\")\n            .equals(round_id)\n            .first()\n            .then(round => dispatch(set_active_round(round)));\n    }\n\nexport default historySlice.reducer;","import { BottomNavigation, BottomNavigationAction, Box, makeStyles } from \"@material-ui/core\";\nimport { SportsEsports, Restore } from \"@material-ui/icons\";\nimport React, { useState } from \"react\";\nimport { Link } from \"react-router-dom\";\n\nconst useStyles = makeStyles({\n    root: {\n        position: \"fixed\",\n        zIndex: 999,\n        bottom: 0,\n        width: \"100%\",\n        marginTop: -56,\n    }\n});\n\nconst Navigation = () => {\n    const pathname = window.location.pathname;\n    const [value, setValue] = useState(pathname);\n    const classes = useStyles();\n\n    return (\n        <Box className={classes.root}>\n            <BottomNavigation\n                value={value}\n                onChange={(_, newValue) => {\n                    setValue(newValue);\n                }}\n                showLabels\n            >\n                <BottomNavigationAction label=\"Play\" value=\"/\" icon={<SportsEsports />} component={Link} to=\"/\" />\n                <BottomNavigationAction label=\"History\" value=\"/history\" icon={<Restore />} component={Link} to=\"/history\" />\n            </BottomNavigation>\n        </Box>\n    );\n}\n\nexport default Navigation;","import { Card, CardActionArea, CardMedia, CardContent, Typography, makeStyles } from \"@material-ui/core\";\nimport { sortBy } from 'lodash';\nimport { Round } from \"./GameDatabase\";\nimport { Tag } from \"./App\";\nimport Matches from \"./GuessMatcher\";\nimport React from \"react\";\nimport { Link } from \"react-router-dom\";\n\nconst TAG_URL = \"https://www.sakugabooru.com/post?tags=\";\nexport const tag_url = (tag: Tag) => TAG_URL + tag.name.split(\" \").join(\"_\");\n\nconst useStyles = makeStyles(theme => ({\n    title: {\n        textOverflow: \"ellipsis\",\n        overflow: \"hidden\",\n        whiteSpace: \"nowrap\",\n    },\n    media: {\n        height: 240,\n    },\n    root: {\n        textDecoration: \"none\",\n        color: theme.palette.text.primary,\n    }\n}));\n\nexport type RoundSummaryProps = {\n    round: Round,\n};\n\nconst RoundSummary = ({ round }: RoundSummaryProps) => {\n    const classes = useStyles();\n    \n    const last_video = round.videos[round.videos.length - 1];\n    const tags = sortBy(last_video.tags, [\"count\"]);\n    const title_tag = tags[tags.length - 1];\n\n    return (\n        <Card>\n            <CardActionArea component=\"div\">\n                <Link to={\"/history/\"+round.id} className={classes.root}>\n                    <CardMedia\n                        component=\"img\"\n                        title={\"Image thumbnail of a clip from \" + round.videos[0].tags[0].name}\n                        alt={\"Image thumbnail of a clip from \" + round.videos[0].tags[0].name}\n                        image={round.videos[0].preview_url}\n                        className={classes.media}\n                    />\n                    <CardContent>\n                        <Typography gutterBottom variant=\"h6\" component=\"h2\" className={classes.title}>\n                            {title_tag.name}\n                        </Typography>\n                        <Typography variant=\"body2\" component=\"p\">\n                            {render_guess(round.guess, tags)}\n                        </Typography>\n                    </CardContent>\n                </Link>\n            </CardActionArea>\n        </Card>\n    );\n};\n\nconst render_guess = (guess: string | undefined, answers: Tag[]) => {\n    const match_result = Matches({ guess, answers });\n    const guess_string = \"\\\"\" + guess + \"\\\" \";\n    return {\n        missing: \"No guess\",\n        correct: guess_string + \"🎉 was correct 🎊\",\n        incorrect: guess_string + \"was incorrect\",\n    }[match_result.result]\n};\n\nexport default RoundSummary;","import { Grid } from \"@material-ui/core\";\nimport { Round } from \"./GameDatabase\";\nimport RoundSummary from \"./RoundSummary\";\n\nconst RoundSummaries = ({rounds}: {rounds: Round[]}) => (\n    <Grid container spacing={2}>\n        {rounds.map((round) => (\n            <Grid key={round.id} item className=\"round-summary\" xs={12} sm={6} md={4}>\n                <RoundSummary round={round} />\n            </Grid>\n        ))}\n    </Grid>\n);\n\nexport default RoundSummaries;","import React, { useEffect } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { useThunkDispatch } from \"./App\";\nimport { RootState } from \"./app/store\";\nimport { load_rounds, load_num_rounds } from \"./historySlice\";\nimport { Pagination } from \"@material-ui/lab\";\nimport { makeStyles } from \"@material-ui/core\";\nimport RoundSummaries from \"./RoundSummaries\";\n\nconst PAGE_SIZE = 12;\n\nconst useStyles = makeStyles({\n    pagination: {\n        margin: \"1em 0\",\n    },\n})\n\nconst PagedRoundSummaries = () => {\n    const dispatch = useThunkDispatch();\n    const { rounds, num_rounds, page } = useSelector((state: RootState) => state.history);\n    const classes = useStyles();\n\n    useEffect(() => dispatch(load_num_rounds()), [dispatch]);\n    useEffect(() => dispatch(load_rounds({ page: 0, page_size: PAGE_SIZE })), [dispatch]);\n\n    const on_page_change = (_: React.ChangeEvent<unknown>, page: number) => {\n        dispatch(load_rounds({ page: page - 1, page_size: PAGE_SIZE }));\n    }\n\n    return (\n        <React.Fragment>\n            <RoundSummaries rounds={rounds} />\n            <Pagination\n                className={classes.pagination}\n                page={page + 1}\n                count={Math.ceil(num_rounds / PAGE_SIZE)}\n                onChange={on_page_change}\n            />\n        </React.Fragment>\n    );\n};\n\nexport default PagedRoundSummaries;","import { Box, Card, CardActions, CardContent, CardMedia, Chip, Container, Grid, IconButton, makeStyles, Typography } from \"@material-ui/core\";\nimport { Link, SaveAlt } from \"@material-ui/icons\";\nimport { sortBy } from \"lodash\";\nimport { Round } from \"./GameDatabase\";\nimport { tag_url } from \"./RoundSummary\";\nimport { Video } from \"./VideoWrapper\";\n\nconst VIDEO_URL = \"https://www.sakugabooru.com/post/show/\";\n\nexport type RoundDetailsProps = {\n    readonly round: Round,\n}\n\nconst useStyles = makeStyles(theme => ({\n    tag_wrapper: {\n        display: 'flex',\n        flexWrap: 'wrap',\n        '& > *': {\n            margin: theme.spacing(0.5),\n        },\n    },\n}));\n\nconst RoundDetails = ({ round }: RoundDetailsProps) => {\n\n    const classes = useStyles();\n\n    const video_ui = (video: Video) => {\n        const tags = sortBy(video.tags, tag => tag.count);\n        const rarest_tag = tags[0];\n        const tags_minus_main = tags.filter(tag => tag.id !== round.tag.id);\n        return (\n            <Grid item key={video.id} xs={12} sm={6} md={4}>\n                <Card>\n                    <CardMedia\n                        component=\"video\"\n                        title={\"Video clip from \" + rarest_tag.name}\n                        src={video.url}\n                        controls\n                        loop\n                        poster={video.preview_url}\n                    />\n                    {\n                        tags_minus_main.length > 0 &&\n                        <CardContent>\n                            <Box className={classes.tag_wrapper}>\n                                {tags_minus_main.map(tag =>\n                                    <Chip label={tag.name} component=\"a\" href={tag_url(tag)} clickable />\n                                )}\n                            </Box>\n                        </CardContent>\n                    }\n                    <CardActions>\n                        <IconButton href={VIDEO_URL + video.id}>\n                            <Link />\n                        </IconButton>\n                        <IconButton href={video.url} download={rarest_tag.name}>\n                            <SaveAlt />\n                        </IconButton>\n                    </CardActions>\n                </Card>\n            </Grid>\n        );\n    }\n\n    return (\n        <Container>\n            <Typography variant=\"h3\" component=\"h1\">\n                {round.tag.name}\n                <IconButton href={tag_url(round.tag)}>\n                    <Link />\n                </IconButton>\n            </Typography>\n\n            <Typography gutterBottom>Popularity: {round.tag.count}</Typography>\n            <Typography gutterBottom>{get_guess(round.guess)}</Typography>\n            <Typography gutterBottom>{new Date(round.date).toDateString()}</Typography>\n            <Grid container spacing={2}>\n                {round.videos.map(video_ui)}\n            </Grid>\n        </Container>\n    )\n};\n\nconst get_guess = (guess?: string) => guess ? \"Your guess: \" + guess : \"No guess\";\n\nexport default RoundDetails;","import { useEffect } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { useThunkDispatch } from \"./App\";\nimport { RootState } from \"./app/store\";\nimport { load_round_details } from \"./historySlice\";\nimport RoundDetails from \"./RoundDetails\";\n\nconst RoundDetailsLoader = ({round_id}:{round_id: number}) => {\n    const dispatch = useThunkDispatch();\n    useEffect(() => dispatch(load_round_details(round_id)), [dispatch, round_id]);\n    const active_round = useSelector((state: RootState) => state.history.active_round);\n\n    return active_round ? <RoundDetails round={active_round} /> : null;\n}\n\nexport default RoundDetailsLoader;","import React, { useEffect } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { useThunkDispatch } from \"./App\";\nimport { RootState } from \"./app/store\";\nimport { load_num_rounds } from \"./historySlice\";\nimport { Container, makeStyles } from \"@material-ui/core\";\nimport Navigation from \"./Navigation\";\nimport { useParams } from \"react-router-dom\";\nimport PagedRoundSummaries from \"./PagedRoundSummaries\";\nimport RoundDetailsLoader from \"./RoundDetailsLoader\";\n\nconst useStyles = makeStyles({\n    container: {\n        paddingBottom: 56,\n    }\n})\n\nconst History = () => {\n    const dispatch = useThunkDispatch();\n    useEffect(() => dispatch(load_num_rounds()), [dispatch]);\n    const { num_rounds } = useSelector((state: RootState) => state.history);\n    const { id } = useParams<{id: string | undefined}>();\n    const classes = useStyles();\n\n    const get_history_ui = () => {\n        if (num_rounds === 0) {\n            return <h1>No game history</h1>;\n        }\n        if (id !== undefined) {\n            return <RoundDetailsLoader round_id={parseInt(id)} />;\n        }\n        return <PagedRoundSummaries />;\n    }\n\n    return (\n        <React.Fragment>\n            <Container className={classes.container}>\n                {get_history_ui()}\n            </Container>\n            <Navigation />\n        </React.Fragment>\n    )\n};\n\nexport default History;","import { Button, Container, makeStyles, Typography } from \"@material-ui/core\";\nimport { Tag, useThunkDispatch } from \"./App\";\nimport { start } from \"./appSlice\";\nimport { choose_random_tags } from './StartButton';\nimport { Round } from \"./GameDatabase\";\nimport History from './History';\nimport React from \"react\";\n\nexport type GameSummaryProps = {\n    rounds: Round[],\n    all_tags: Tag[],\n};\n\nconst useContainerStyles = makeStyles({\n    root: {\n        paddingBottom:56,\n    }\n});\n\nconst GameSummary = ({rounds, all_tags}: GameSummaryProps) => {\n    const dispatch = useThunkDispatch();\n    const container_classes = useContainerStyles();\n\n    return (\n        <Container classes={container_classes}>\n            <Typography variant=\"h3\" component=\"h1\" gutterBottom align=\"center\">Game Summary</Typography>\n            <div id=\"play-again\">\n                <Button\n                    variant=\"contained\"\n                    onClick={() => dispatch(start(choose_random_tags(all_tags)))}\n                    color=\"primary\"\n                >\n                    Play Again\n                </Button>\n            </div>\n            <History />\n        </Container>\n    )\n}\n\nexport default GameSummary;","import { makeStyles, Step, StepConnector, StepIconProps, StepLabel, Stepper, withStyles } from \"@material-ui/core\";\nimport clsx from \"clsx\";\nimport guess_matches, { Guess } from \"./GuessMatcher\";\n\n\nconst useProgressStepIconStyles = makeStyles(theme => ({\n    root: {\n        display: 'flex',\n        height: 22,\n        alignItems: 'center',\n        color: theme.palette.background.default,\n    },\n    active: {\n        color: theme.palette.text.primary,\n    },\n    circle: {\n        width: 6,\n        height: 6,\n        borderRadius: '50%',\n        border: \"1px solid #aaa\",\n        backgroundColor: 'currentColor',\n    },\n    completed: {\n        color: theme.palette.secondary.main,\n        zIndex: 1,\n        fontSize: 18,\n        border: \"none\",\n    },\n    correct: {\n        color: theme.palette.primary.main,\n    }\n}));\n\nconst ProgressStepIcon = (correct: boolean) => {\n    const classes = useProgressStepIconStyles();\n    return  (props: StepIconProps) => {\n        const { active, completed } = props;\n    \n        let progressClass = classes.circle;\n\n        if (completed) {\n            progressClass += \" \" + classes.completed;\n            if (correct) {\n                progressClass += \" \" + classes.correct;\n            }\n        }\n    \n        return (\n            <div\n                className={clsx(classes.root, {\n                    [classes.active]: active,\n                })}\n            >\n                <div className={progressClass} />\n            </div>\n        );\n    };\n}\n\nconst progressStyles = makeStyles({\n    root: {\n        background: \"rgba(2, 2, 2, .5)\",\n        zIndex: 100000,\n        height: 22,\n        padding: 8,\n        margin: 5,\n        borderRadius: \"10px\",\n        position: \"fixed\",\n        bottom: 10,\n        left: \"50%\",\n        transform: \"translateX(-50%)\",\n    }\n})\n\n\nconst ProgressConnector = withStyles({\n    root: {\n        display: \"none\",\n    }\n})(StepConnector);\n\nconst Progress = ({ activeStep, steps, guesses }: { activeStep: number, steps: string[], guesses: Guess[] }) => {\n    const classes = progressStyles();\n    const CorrectIcon = ProgressStepIcon(true);\n    const IncorrectIcon = ProgressStepIcon(false);\n    return (\n        <Stepper activeStep={activeStep} className={classes.root} connector={<ProgressConnector />}>\n            {steps.map((label, index) => {\n                const is_correct = guesses[index] && guess_matches(guesses[index]).result === \"correct\";\n                return (\n                    <Step key={index}>\n                        <StepLabel StepIconComponent={is_correct ? CorrectIcon : IncorrectIcon}></StepLabel>\n                    </Step>\n                );\n            })}\n        </Stepper>\n    );\n}\n\nexport default Progress;","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import { configureStore, ThunkAction, Action } from '@reduxjs/toolkit';\nimport appReducer from '../appSlice';\nimport historyReducer from '../historySlice';\n\nexport const store = configureStore({\n  reducer: {\n    app: appReducer,\n    history: historyReducer,\n  },\n});\n\nexport type RootState = ReturnType<typeof store.getState>;\nexport type AppThunk<ReturnType = void> = ThunkAction<\n  ReturnType,\n  RootState,\n  unknown,\n  Action<string>\n>;\n","import { createMuiTheme } from '@material-ui/core/styles';\nimport { lightBlue, red } from '@material-ui/core/colors';\n\nexport default createMuiTheme({\n    palette: {\n        type: 'dark',\n        primary: lightBlue,\n        secondary: red\n    },\n});","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport { ThemeProvider } from '@material-ui/styles';\nimport { store } from './app/store';\nimport { Provider } from 'react-redux';\nimport { CssBaseline } from '@material-ui/core';\nimport { Route, BrowserRouter as Router, Switch } from 'react-router-dom';\nimport History from './History';\nimport dark_theme from './dark_theme';\n\nReactDOM.render(\n  <React.StrictMode>\n    <ThemeProvider theme={dark_theme}>\n      <CssBaseline />\n      <Provider store={store}>\n        <Router>\n          <Switch>\n            <Route path=\"/history/:id\">\n              <History />\n            </Route>\n            <Route path=\"/history\">\n              <History />\n            </Route>\n            <Route path=\"/\">\n              <App />\n            </Route>\n          </Switch>\n        </Router>\n      </Provider>\n    </ThemeProvider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}