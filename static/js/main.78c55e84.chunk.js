(this.webpackJsonpaniguesser=this.webpackJsonpaniguesser||[]).push([[0],{129:function(e,t,n){},135:function(e,t,n){"use strict";n.r(t),n.d(t,"dark_theme",(function(){return ke}));var s=n(0),a=n.n(s),r=n(11),i=n.n(r),c=(n(96),n(25)),u=n(30),o=n(72),l=n.n(o),d=(n(129),n(15)),g=n(178),j=n(193),m=n(180),v=n(181),b=n(194),p=n(73),h=n(47),f={videos:[],guesses:[],index:0,guess_to_show:void 0,playing:!1,tags:[]},O=Object(h.b)({name:"app",initialState:f,reducers:{change_video:function(e,t){var n,s=t.payload,a=e.index,r=null===(n=e.guesses[a])||void 0===n?void 0:n.guess;e.guesses[a]={guess:r,answers:s.tags},e.videos[a]?e.videos[a].push(s):e.videos[a]=[s]},submit_guess:function(e){var t,n,s=e.guesses,a=e.index,r=e.videos[a];void 0!==r&&(e.guess_to_show=a,s[a]||(s[a]={answers:null!==(t=null===(n=r[r.length-1])||void 0===n?void 0:n.tags)&&void 0!==t?t:[]}))},show_next_tag:function(e){var t=e.index;t+1<ve.length?e.index=t+1:(e.index=0,e.playing=!1),e.guess_to_show=void 0},start:function(e,t){e.index=0,e.guesses=[],e.playing=!0,e.tags=t.payload},change_guess:function(e,t){var n,s,a=t.payload,r=e.index,i=e.videos[r];i&&(e.guesses[r]={guess:a,answers:null!==(n=null===(s=i[i.length-1])||void 0===s?void 0:s.tags)&&void 0!==n?n:[]})}}}),x=O.actions,_=x.change_video,w=x.show_next_tag,y=x.start,C=x.submit_guess,N=x.change_guess,T=O.reducer,k=n(173),A=n(177),S=n(75),E=n(5),R=function(e){var t=e.duration,n=e.size,a=e.type,r=e.on_time_over,i=e.interval,c=void 0===i?50:i,u=e.className,o=e.count_down,l=void 0!==o&&o,g=e.show_emergency_color,j=void 0!==g&&g,m=1e3*t/c,v=Object(S.useTimer)({endTime:m,interval:c,onTimeOver:r}),b=v.time,p=v.start,h=v.reset;Object(s.useEffect)((function(){return p(),h}),[h,p]);var f=function(e){return 100*(l?m-e:e)/m},O={color:f(b)<25&&j?"secondary":"primary",variant:"determinate",value:f(b),className:u};return"linear"===a?Object(E.jsx)(k.a,Object(d.a)({},O)):Object(E.jsx)(A.a,Object(d.a)({size:n},O))},I=Object(g.a)({wrapper:{position:"relative"},fabProgress:{position:"absolute",top:-6,left:-6}}),P={keys:[function(e){return e.name}],baseSort:function(e,t){return t.item.count-e.item.count}},F=function(e,t){var n=t.inputValue;return n?Object(p.a)(e,n,P).slice(0,100):[]},H=function(e){var t=e.all_tags,n=fe(),a=I(),r=Object(s.useState)(null),i=Object(c.a)(r,2),u=i[0],o=i[1];return Object(E.jsxs)("form",{id:"guess",onSubmit:function(e){e.preventDefault(),u&&n(C())},children:[Object(E.jsx)("div",{id:"guess-input",children:Object(E.jsx)(b.a,{selectOnFocus:!0,clearOnBlur:!0,autoHighlight:!0,autoComplete:!0,disableClearable:!0,clearOnEscape:!0,options:t,style:{width:300},filterOptions:F,getOptionLabel:function(e){return e.name},onChange:function(e,t){var s;o(t),n(N(null!==(s=null===t||void 0===t?void 0:t.name)&&void 0!==s?s:""))},renderInput:function(e){return Object(E.jsx)(j.a,Object(d.a)(Object(d.a)({},e),{},{label:"Guess the title",variant:"filled",autoFocus:!0}))}})}),Object(E.jsxs)("div",{className:a.wrapper,children:[Object(E.jsx)(R,{size:68,duration:30,on_time_over:function(){return n(C())},count_down:!0,show_emergency_color:!0,className:a.fabProgress}),Object(E.jsx)(m.a,{type:"submit","area-label":"submit",children:Object(E.jsx)(v.a,{})})]})]})},G=n(36),B=n.n(G),L=n(57),z=n(46);function Y(){return(Y=Object(L.a)(B.a.mark((function e(){var t,n;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/tag.json?limit=0&order=count&type="+K.COPYRIGHT);case 2:return t=e.sent,e.next=5,t.json();case 5:return n=e.sent.map(M),e.abrupt("return",n.filter((function(e){return e.count>0})));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e){return J.apply(this,arguments)}function J(){return(J=Object(L.a)(B.a.mark((function e(t){var n,s,a,r,i,c,u;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.tag,a=t.page,r=null!==(n=r=void 0===a?void 0:a)&&void 0!==n?n:Object(z.random)(s.count),i="/api/post.json?limit=1&page="+r+"&tags="+s.name.replaceAll(" ","_")+" rating:safe",e.next=5,fetch(i);case 5:return c=e.sent,e.next=8,c.json();case 8:if(!q((u=e.sent)[0])){e.next=13;break}return e.abrupt("return",{data:u[0],page:r});case 13:return e.abrupt("return",D({tag:s,page:V(r,s)}));case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var M=function(e){return{ambiguous:e.ambiguous,count:e.count,id:e.id,name:e.name.replaceAll("_"," "),type:e.type}},V=function(e,t){return(e+1)%t.count};function q(e){return e&&e.file_url&&("mp4"===e.file_ext||"webm"===e.file_ext)&&e.id}var K,Q=function(e){var t=e.tag,n=e.video,a=e.video_wrapper,r=Object(s.useState)(void 0),i=Object(c.a)(r,2),u=i[0],o=i[1],l=fe();Object(s.useEffect)((function(){var e=!0;return D({tag:t}).then((function(t){if(e){var n=a.wrap(t.data);l(_(n)),o(t.page)}})),function(){e=!1}}),[t,a,l]);var d=function(e){var t=a.wrap(e.data);l(_(t)),o(e.page)};return Object(E.jsx)("video",{muted:!0,preload:"auto",autoPlay:!0,src:null===n||void 0===n?void 0:n.url,onEnded:function(){var e=V(u,t);D({tag:t,page:e}).then(d)}})},U=n(189),W=Object(g.a)({timer:{width:"100%"}}),X=function(e){return e.length>0?Object(E.jsxs)("p",{children:["it was ",Object(z.sortBy)(e,(function(e){return e.count}))[e.length-1].name]}):null},Z=function(e){var t=e.guess_result,n=fe(),s=W(),a=Object(E.jsx)(R,{duration:4,on_time_over:function(){return n(w())},type:"linear",className:s.timer});return t.match_result.matches&&t.guess.guess?Object(E.jsxs)("div",{id:"guess-result",className:"controls correct",children:[Object(E.jsx)("p",{children:t.guess.guess}),!t.match_result.exact&&Object(E.jsxs)("p",{children:["(",t.match_result.closest,")"]}),Object(E.jsx)("h1",{children:"\ud83c\udf89 is correct \ud83c\udf8a"}),a]}):t.guess.guess?Object(E.jsxs)("div",{id:"guess-result",className:"controls wrong",children:[Object(E.jsx)("p",{id:"incorrect-guess",children:t.guess.guess}),Object(E.jsx)("h1",{children:"is incorrect"}),X(t.guess.answers),a]}):Object(E.jsxs)("div",{id:"guess-result",className:"controls wrong",children:[Object(E.jsx)("h1",{children:"No guess"}),X(t.guess.answers),a]})},$=function(e){var t=e.score,n=e.max_score;return Object(E.jsxs)("p",{id:"score",className:"controls",children:["Correct: ",t,"/",n]})},ee=n(84),te=function(e){var t,n;if(!e.guess)return{matches:!1,exact:!1};var s=new ee.a(e.answers.map((function(e){return e.name})),{includeScore:!0,threshold:.1}).search(e.guess);return{matches:s.length>0,exact:0===(null===(t=s[0])||void 0===t?void 0:t.score),closest:null===(n=s[0])||void 0===n?void 0:n.item}},ne=n(13),se=n(14),ae=n(82),re=function(){function e(t){Object(ne.a)(this,e),this.tags_by_name=void 0,this.tags_by_name=Object(ae.a)(t.map((function(e){return[e.name,e]})))}return Object(se.a)(e,[{key:"wrap",value:function(e){var t=this;return{tags:e.tags.split(" ").map((function(e){return e.replaceAll("_"," ")})).map((function(e){return t.tags_by_name.get(e)})).filter((function(e){return void 0!==e})),url:e.file_url,id:e.id,preview_url:e.preview_url}}}]),e}(),ie=n(182),ce=n(183),ue=n(184),oe=n(185),le=n(186),de=n(187),ge=n(188),je=Object(g.a)({root:{minHeight:250}}),me=function(e){var t=e.rounds,n=e.all_tags,s=fe(),a=je();return Object(E.jsxs)(ge.a,{children:[Object(E.jsx)(ie.a,{container:!0,spacing:2,children:t.map((function(e,t){return Object(E.jsx)(ie.a,{item:!0,className:"round-summary",xs:12,sm:6,md:4,children:Object(E.jsx)(ce.a,{classes:a,children:Object(E.jsxs)(ue.a,{href:"https://www.sakugabooru.com/post?tags="+e.tag.name.replaceAll(" ","_"),target:"_blank",children:[Object(E.jsx)(oe.a,{component:"img",title:"Image thumbnail of a clip from "+e.videos[0].tags[0].name,alt:"Image thumbnail of a clip from "+e.videos[0].tags[0].name,image:e.videos[0].preview_url}),Object(E.jsxs)(le.a,{children:[Object(E.jsx)(de.a,{gutterBottom:!0,variant:"h5",component:"h2",children:e.tag.name}),Object(E.jsx)(de.a,{variant:"body2",component:"p",children:(n=e.guess,n.guess?'"'+n.guess+'" '+(te(n).matches?"\ud83c\udf89 was correct \ud83c\udf8a":"was incorrect"):"No guess")})]})]})})},t);var n}))}),Object(E.jsx)("div",{id:"play-again",children:Object(E.jsx)(U.a,{variant:"contained",onClick:function(){return s(y(be(n)))},color:"primary",children:"Play Again"})})]})};!function(e){e[e.GENERAL=0]="GENERAL",e[e.ARTIST=1]="ARTIST",e[e.COPYRIGHT=3]="COPYRIGHT",e[e.CHARACTER=4]="CHARACTER"}(K||(K={}));var ve=[{max:1e5,min:500},{max:1e5,min:500},{max:1e5,min:500},{max:500,min:100},{max:500,min:100},{max:500,min:100},{max:500,min:100},{max:500,min:100},{max:100,min:25},{max:25,min:1},{max:25,min:1},{max:1,min:1}];function be(e){return ve.map((function(t){var n=t.max,s=t.min;return l()(e.filter((function(e){var t=e.count;return n>=t&&t>=s})))}))}function pe(e,t){return void 0!==t?e+1:e}function he(e,t){for(var n=0,s=0;s<t;s++)te(e[s]).matches&&(n+=1);return n}var fe=function(){return Object(u.b)()};var Oe=function(){var e=Object(u.c)((function(e){return e.app})),t=e.guesses,n=e.index,r=e.videos,i=e.guess_to_show,o=e.playing,l=e.tags,d=Object(u.c)((function(e){for(var t=e.app,n=t.tags.length,s=[],a=0;a<n;a++)s.push({tag:t.tags[a],videos:t.videos[a],guess:t.guesses[a]});return s})),g=fe(),j=Object(s.useState)([]),m=Object(c.a)(j,2),v=m[0],b=m[1],p=Object(s.useState)(void 0),h=Object(c.a)(p,2),f=h[0],O=h[1];return Object(s.useEffect)((function(){(function(){return Y.apply(this,arguments)})().then((function(e){b(e),O(new re(e))}))}),[]),!o&&t.length>0?Object(E.jsx)(me,{rounds:d,all_tags:v}):Object(E.jsxs)("div",{id:"game",children:[o&&Object(E.jsx)($,{score:he(t,pe(n,i)),max_score:pe(n,i)}),0===v.length&&Object(E.jsx)(R,{duration:.8}),!o&&0===t.length&&v.length>0&&Object(E.jsx)(U.a,{variant:"contained",disabled:0===v.length,onClick:function(){return g(y(be(v)))},id:"start",children:"Start"}),o&&l.length>0&&void 0===i&&f&&Object(E.jsxs)(a.a.Fragment,{children:[Object(E.jsx)(Q,{tag:l[n],video:r[n]?r[n][r[n].length-1]:void 0,video_wrapper:f}),r[n]&&Object(E.jsx)(H,{all_tags:v})]}),void 0!==i&&Object(E.jsx)(Z,{guess_result:{guess:t[i],match_result:te(t[i])}})]})},xe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,195)).then((function(t){var n=t.getCLS,s=t.getFID,a=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),s(e),a(e),r(e),i(e)}))},_e=n(191),we=n(83),ye=n(190),Ce=n(49),Ne=Object(h.a)({reducer:{app:T}}),Te=n(192),ke=Object(we.a)({palette:{type:"dark",primary:ye.a,secondary:Ce.a}});i.a.render(Object(E.jsx)(a.a.StrictMode,{children:Object(E.jsxs)(_e.a,{theme:ke,children:[Object(E.jsx)(Te.a,{}),Object(E.jsx)(u.a,{store:Ne,children:Object(E.jsx)(Oe,{})})]})}),document.getElementById("root")),xe()},96:function(e,t,n){}},[[135,1,2]]]);
//# sourceMappingURL=main.78c55e84.chunk.js.map