(this.webpackJsonpaniguesser=this.webpackJsonpaniguesser||[]).push([[0],{104:function(e,t,n){},111:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(11),i=n.n(a),u=(n(76),n(20)),s=n.n(u),o=n(25),l=n(16),d=n(55),j=n.n(d),f=(n(104),n(43)),m=n(153),b=n(154),x=n(10),O=function(e){var t=e.all_tags,n=e.on_guess_submitted;return Object(x.jsx)("div",{id:"guess",className:"controls",children:Object(x.jsx)(b.a,{blurOnSelect:!0,disableClearable:!0,options:t,style:{width:300},getOptionLabel:function(e){return e.name.replaceAll("_"," ")},onChange:function(e,t){var r;return n(null!==(r=null===t||void 0===t?void 0:t.name)&&void 0!==r?r:"")},renderInput:function(e){return Object(x.jsx)(m.a,Object(f.a)(Object(f.a)({},e),{},{label:"Guess the title"}))}})})},p=n(63);function v(e){return g.apply(this,arguments)}function g(){return(g=Object(o.a)(s.a.mark((function e(t){var n,r,c,a,i,u,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.tag,r=t.index,c=void 0===r?void 0:r,a=Object(p.random)(n.count),i="/api/post.json?limit=1&page="+(null!==c&&void 0!==c?c:a)+"&tags="+n.name,e.next=5,fetch(i);case 5:return u=e.sent,e.next=8,u.json();case 8:if(!h((o=e.sent)[0])){e.next=13;break}return e.abrupt("return",{url:o[0].file_url,id:o[0].id,tag:n});case 13:return e.abrupt("return",v({tag:n,index:(a+1)%n.count}));case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return e&&e.file_url&&("mp4"===e.file_ext||"webm"===e.file_ext)&&e.id}var _,w=function(e){var t=e.tags,n=e.on_end,a=e.current_video,i=e.set_current_video,u=e.index,s=e.set_index,o=e.play_next;return Object(r.useEffect)((function(){var e=!0;return t.length>0&&v({tag:t[u]}).then((function(t){e&&i(t)})),function(){e=!1}}),[t,u,i]),Object(r.useEffect)((function(){var e=function(e){"ArrowRight"===e.key&&o()};return window&&window.addEventListener("keyup",e),function(){window.removeEventListener("keyup",e)}}),[u,t,n,s,o]),Object(x.jsx)(c.a.Fragment,{children:Object(x.jsx)("video",{muted:!0,preload:"auto",autoPlay:!0,src:null===a||void 0===a?void 0:a.url,onEnded:o})})},E=n(151),S=n(42),y=function(e){var t=e.guess_result;return void 0===t?null:t.is_correct?Object(x.jsxs)("p",{id:"guess-result",className:"controls correct",children:[t.correct_answer.replaceAll("_"," ")," \u2713"]}):Object(x.jsxs)("div",{id:"guess-result",className:"controls wrong",children:[Object(x.jsx)("p",{id:"incorrect-guess",children:t.guess.replaceAll("_"," ")}),Object(x.jsx)("p",{children:t.correct_answer.replaceAll("_"," ")})]})},C=function(e){var t=e.score,n=e.max_score;return Object(x.jsxs)("p",{id:"score",className:"controls",children:["Correct: ",t,"/",n]})};function A(e,t){return e===t.tag.name}function R(){return(R=Object(o.a)(s.a.mark((function e(){var t,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/tag.json?limit=0&order=count");case 2:return t=e.sent,e.next=5,t.json();case 5:return n=e.sent,e.abrupt("return",n.filter((function(e){return e.count>0})));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(e){e[e.GENERAL=0]="GENERAL",e[e.ARTIST=1]="ARTIST",e[e.COPYRIGHT=3]="COPYRIGHT",e[e.CHARACTER=4]="CHARACTER"}(_||(_={}));var T=[{max:1e5,min:500},{max:1e5,min:500},{max:1e5,min:500},{max:500,min:100},{max:500,min:100},{max:500,min:100},{max:500,min:100},{max:500,min:100},{max:500,min:100},{max:100,min:25},{max:100,min:25},{max:100,min:25},{max:100,min:25},{max:25,min:10},{max:25,min:10},{max:25,min:10},{max:25,min:10},{max:1,min:1}],k=function(){var e=Object(r.useState)([]),t=Object(l.a)(e,2),n=t[0],a=t[1],i=Object(r.useState)([]),u=Object(l.a)(i,2),s=u[0],o=u[1],d=Object(r.useState)(!1),f=Object(l.a)(d,2),m=f[0],b=f[1],p=Object(r.useState)(!1),v=Object(l.a)(p,2),g=v[0],h=v[1],k=Object(r.useState)(Object(S.a)()),I=Object(l.a)(k,2),L=I[0],F=I[1],G=Object(r.useState)(void 0),N=Object(l.a)(G,2),P=N[0],H=N[1],Y=Object(r.useState)(0),B=Object(l.a)(Y,2),J=B[0],D=B[1],M=Object(r.useState)(0),q=Object(l.a)(M,2),z=q[0],K=q[1],Q=Object(r.useState)(void 0),U=Object(l.a)(Q,2),V=U[0],W=U[1];Object(r.useEffect)((function(){(function(){return R.apply(this,arguments)})().then((function(e){return a(e.filter((function(e){return e.type===_.COPYRIGHT})))}))}),[]),Object(r.useEffect)((function(){setTimeout((function(){return W(void 0)}),2500)}),[V]);var X=function(){z+1<s.length?K(z+1):Z()},Z=function(){b(!1),o([])},$=function(e){var t=0;e.forEach((function(e,n){A(e,n)&&(t+=1)})),D(t)};return Object(x.jsxs)(c.a.Fragment,{children:[g&&Object(x.jsx)(C,{score:J,max_score:z}),!m&&!V&&Object(x.jsx)(E.a,{variant:"contained",disabled:0===n.length,onClick:function(){var e;o((e=n,T.map((function(t){var n=t.max,r=t.min;return j()(e.filter((function(e){var t=e.count;return n>=t&&t>=r})))})))),b(!0),h(!0),F(Object(S.a)()),D(0),K(0)},id:"start",children:"Start"}),m&&!V&&Object(x.jsx)(w,{tags:s,on_end:Z,current_video:P,set_current_video:H,index:z,set_index:K,play_next:X}),Object(x.jsx)(y,{guess_result:V}),m&&!V&&Object(x.jsx)(O,{on_guess_submitted:function(e){if(void 0!==P){var t=L.set(P,e);!function(e,t){W({guess:t,correct_answer:e.tag.name,is_correct:A(t,e)})}(P,e),F(t),$(t),X()}},all_tags:n})]})},I=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,155)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),r(e),c(e),a(e),i(e)}))},L=n(152),F=n(64),G=Object(F.a)({palette:{type:"dark"}});i.a.render(Object(x.jsx)(c.a.StrictMode,{children:Object(x.jsx)(L.a,{theme:G,children:Object(x.jsx)(k,{})})}),document.getElementById("root")),I()},76:function(e,t,n){}},[[111,1,2]]]);
//# sourceMappingURL=main.d98b4a99.chunk.js.map