(this.webpackJsonpaniguesser=this.webpackJsonpaniguesser||[]).push([[0],{112:function(e,t,n){},120:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(11),s=n.n(c),i=(n(85),n(12)),u=n(60),o=n.n(u),l=(n(112),n(17)),j=n(165),d=n(159),b=n(160),m=n(166),f=n(61),O=n(6),v={keys:[function(e){return e.name}],baseSort:function(e,t){return t.item.count-e.item.count}},g=function(e,t){var n=t.inputValue;return n?Object(f.a)(e,n,v).slice(0,100):[]},x=function(e){var t=e.on_guess_changed,n=e.on_guess_submitted,r=e.all_tags;return Object(O.jsxs)("form",{id:"guess",onSubmit:function(e){e.preventDefault(),n()},children:[Object(O.jsx)(m.a,{selectOnFocus:!0,clearOnBlur:!0,autoHighlight:!0,autoComplete:!0,disableClearable:!0,clearOnEscape:!0,options:r,style:{width:300},filterOptions:g,getOptionLabel:function(e){return e.name},onChange:function(e,n){var r;return t(null!==(r=null===n||void 0===n?void 0:n.name)&&void 0!==r?r:"")},renderInput:function(e){return Object(O.jsx)(j.a,Object(l.a)(Object(l.a)({},e),{},{label:"Guess the title",variant:"filled",autoFocus:!0}))}}),Object(O.jsx)(d.a,{type:"submit",children:Object(O.jsx)(b.a,{children:"send"})})]})},p=n(161),h=n(27),_=n.n(h),S=n(46),w=n(70);function y(){return(y=Object(S.a)(_.a.mark((function e(){var t,n;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/tag.json?limit=0&order=count&type="+T.COPYRIGHT);case 2:return t=e.sent,e.next=5,t.json();case 5:return n=e.sent.map((function(e){return{ambiguous:e.ambiguous,count:e.count,id:e.id,name:e.name.replaceAll("_"," "),type:e.type}})),e.abrupt("return",n.filter((function(e){return e.count>0})));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(e){return C.apply(this,arguments)}function C(){return(C=Object(S.a)(_.a.mark((function e(t){var n,r,a,c,s,i,u;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.tag,a=t.page,c=null!==(n=c=void 0===a?void 0:a)&&void 0!==n?n:Object(w.random)(r.count),s="/api/post.json?limit=1&page="+c+"&tags="+r.name.replaceAll(" ","_"),e.next=5,fetch(s);case 5:return i=e.sent,e.next=8,i.json();case 8:if(!R((u=e.sent)[0])){e.next=13;break}return e.abrupt("return",{data:{url:u[0].file_url,id:u[0].id,tag:r},page:c});case 13:return e.abrupt("return",I({tag:r,page:E(c,r)}));case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var E=function(e,t){return(e+1)%t.count};function R(e){return e&&e.file_url&&("mp4"===e.file_ext||"webm"===e.file_ext)&&e.id}var T,A=3e4,N=function(e){return 100*(A-e)/A},k=function(e){var t=e.tag,n=e.current_video,c=e.set_current_video,s=e.play_next_tag,u=Object(r.useState)(void 0),o=Object(i.a)(u,2),l=o[0],j=o[1],d=Object(r.useState)(0),b=Object(i.a)(d,2),m=b[0],f=b[1];Object(r.useEffect)((function(){var e=!0;return I({tag:t}).then((function(t){e&&(c(t.data),j(t.page))})),function(){e=!1}}),[t,c]),Object(r.useEffect)((function(){var e=0;console.log("starting interval");var t=setInterval((function(){e>=A?(f(e=0),s()):f(e+=50)}),50);return function(){clearInterval(t),console.log("clearing interval")}}),[t]);return Object(O.jsxs)(a.a.Fragment,{children:[Object(O.jsx)(p.a,{color:N(m)<25?"secondary":"primary",variant:"determinate",value:N(m),className:"controls timer"},t.id),Object(O.jsx)("video",{muted:!0,preload:"auto",autoPlay:!0,src:null===n||void 0===n?void 0:n.url,onEnded:function(){var e=E(l,t);I({tag:t,page:e}).then((function(e){c(e.data),j(e.page)}))}})]})},F=n(162),G=n(47),H=function(e){var t=e.guess_result;return void 0===t?null:t.is_correct&&t.guess?Object(O.jsxs)("div",{id:"guess-result",className:"controls correct",children:[Object(O.jsx)("p",{children:t.guess}),t.guess!==t.correct_answer&&Object(O.jsxs)("p",{children:["(",t.correct_answer,")"]}),Object(O.jsx)("h1",{children:"\ud83c\udf89 is correct \ud83c\udf8a"})]}):t.guess?Object(O.jsxs)("div",{id:"guess-result",className:"controls wrong",children:[Object(O.jsx)("p",{id:"incorrect-guess",children:t.guess}),Object(O.jsx)("h1",{children:"is incorrect"}),Object(O.jsxs)("p",{children:["It was ",t.correct_answer]})]}):Object(O.jsxs)("div",{id:"guess-result",className:"controls wrong",children:[Object(O.jsx)("h1",{children:"No guess"}),Object(O.jsxs)("p",{children:["It was ",t.correct_answer]})]})},P=function(e){var t=e.score,n=e.max_score;return Object(O.jsxs)("p",{id:"score",className:"controls",children:["Correct: ",t,"/",n]})},L=n(72),B=function(e){return new L.a([e.answer],{includeScore:!0,threshold:.1,distance:0}).search(e.guess).length>0};!function(e){e[e.GENERAL=0]="GENERAL",e[e.ARTIST=1]="ARTIST",e[e.COPYRIGHT=3]="COPYRIGHT",e[e.CHARACTER=4]="CHARACTER"}(T||(T={}));var Y=4e3,D=function(e){return 100*e/Y};function J(e,t){return void 0!==e&&B({guess:e,answer:t.name})}var M=[{max:1e5,min:500},{max:1e5,min:500},{max:1e5,min:500},{max:1e5,min:500},{max:1e5,min:500},{max:500,min:100},{max:500,min:100},{max:500,min:100},{max:500,min:100},{max:500,min:100},{max:500,min:100},{max:500,min:100},{max:100,min:25},{max:100,min:25},{max:100,min:25},{max:25,min:1},{max:25,min:1},{max:1,min:1}],V=function(){var e=Object(r.useState)(0),t=Object(i.a)(e,2),n=t[0],c=t[1],s=Object(r.useState)([]),u=Object(i.a)(s,2),l=u[0],j=u[1],d=Object(r.useState)([]),b=Object(i.a)(d,2),m=b[0],f=b[1],v=Object(r.useState)(!1),g=Object(i.a)(v,2),h=g[0],_=g[1],S=Object(r.useState)(!1),w=Object(i.a)(S,2),I=w[0],C=w[1],E=Object(r.useState)(Object(G.a)()),R=Object(i.a)(E,2),T=R[0],A=R[1],N=Object(r.useState)(void 0),L=Object(i.a)(N,2),B=L[0],V=L[1],q=Object(r.useState)(0),z=Object(i.a)(q,2),K=z[0],Q=z[1],U=Object(r.useState)(0),W=Object(i.a)(U,2),X=W[0],Z=W[1],$=Object(r.useState)(void 0),ee=Object(i.a)($,2),te=ee[0],ne=ee[1],re=Object(r.useState)(0),ae=Object(i.a)(re,2),ce=ae[0],se=ae[1];Object(r.useEffect)((function(){var e=10;c(e);var t=setInterval((function(){e<90?c(e+=10):clearInterval(t)}),100);return function(){return y.apply(this,arguments)}().then((function(e){c(100),j(e)})),function(){return clearInterval(t)}}),[]),Object(r.useEffect)((function(){if(te){oe(T);var e=0,t=setInterval((function(){e>=Y?(ne(void 0),e=0):e+=50,se(e)}),50);return function(){return clearInterval(t)}}}),[T,te]);var ie=function(){var e=m[X];ne(e),X+1<m.length?Z(X+1):ue()},ue=function(){_(!1),f([])},oe=function(e){var t=0;e.forEach((function(e,n){J(e,n)&&(t+=1)})),Q(t)};return Object(O.jsxs)(a.a.Fragment,{children:[te&&Object(O.jsx)(p.a,{variant:"determinate",value:D(ce),className:"controls timer"},X),I&&Object(O.jsx)(P,{score:K,max_score:X}),0===l.length&&Object(O.jsx)(p.a,{variant:"determinate",value:n}),!h&&Object(O.jsx)(F.a,{variant:"contained",disabled:0===l.length,onClick:function(){var e;f((e=l,M.map((function(t){var n=t.max,r=t.min;return o()(e.filter((function(e){var t=e.count;return n>=t&&t>=r})))})))),_(!0),C(!0),A(Object(G.a)()),Q(0),Z(0)},id:"start",children:"Start"}),h&&m.length>0&&!te&&Object(O.jsx)(k,{tag:m[X],current_video:B,set_current_video:V,play_next_tag:ie}),te&&Object(O.jsx)(H,{guess_result:{guess:T.get(te),correct_answer:te.name,is_correct:J(T.get(te),te)}}),h&&!te&&Object(O.jsx)(x,{on_guess_changed:function(e){var t=m[X];if(t){var n=T.set(t,e);A(n)}},on_guess_submitted:function(){var e=m[X];T.get(e)&&ie()},all_tags:l})]})},q=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,167)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),r(e),a(e),c(e),s(e)}))},z=n(164),K=n(71),Q=n(163),U=n(38),W=Object(K.a)({palette:{type:"dark",primary:Q.a,secondary:U.a}});s.a.render(Object(O.jsx)(a.a.StrictMode,{children:Object(O.jsx)(z.a,{theme:W,children:Object(O.jsx)(V,{})})}),document.getElementById("root")),q()},85:function(e,t,n){}},[[120,1,2]]]);
//# sourceMappingURL=main.66d198e8.chunk.js.map