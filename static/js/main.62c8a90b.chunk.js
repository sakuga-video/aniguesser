(this.webpackJsonpaniguesser=this.webpackJsonpaniguesser||[]).push([[0],{111:function(e,t,n){},118:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(11),s=n.n(c),i=(n(83),n(21)),u=n.n(i),o=n(28),l=n(12),j=n(61),b=n.n(j),d=(n(111),n(17)),f=n(163),m=n(157),O=n(158),v=n(164),g=n(6),x=function(e){var t=e.on_guess_changed,n=e.on_tag_search,r=e.on_guess_submitted,a=e.options;return Object(g.jsxs)("form",{id:"guess",onSubmit:function(e){e.preventDefault(),r()},children:[Object(g.jsx)(v.a,{selectOnFocus:!0,clearOnBlur:!0,autoHighlight:!0,autoComplete:!0,disableClearable:!0,clearOnEscape:!0,options:a,style:{width:300},getOptionLabel:function(e){return e.name.replaceAll("_"," ")},onChange:function(e,n){var r;return t(null!==(r=null===n||void 0===n?void 0:n.name)&&void 0!==r?r:"")},onInputChange:function(e,t){return n(t)},renderInput:function(e){return Object(g.jsx)(f.a,Object(d.a)(Object(d.a)({},e),{},{label:"Guess the title",variant:"filled"}))}}),Object(g.jsx)(m.a,{type:"submit",children:Object(g.jsx)(O.a,{children:"send"})})]})},h=n(159),p=n(69),_=3e4,S=function(e){return 100*(_-e)/_},w=function(e,t){return(e+1)%t.count};var I,y=function(e){var t=e.tag,n=e.current_video,c=e.set_current_video,s=e.play_next_tag,i=Object(r.useState)(void 0),j=Object(l.a)(i,2),b=j[0],d=j[1],f=Object(r.useState)(0),m=Object(l.a)(f,2),O=m[0],v=m[1];Object(r.useEffect)((function(){var e=!0;return x({tag:t}).then((function(t){e&&c(t)})),function(){e=!1}}),[t,c]),Object(r.useEffect)((function(){var e=0;console.log("starting interval");var t=setInterval((function(){e>=_?(v(e=0),s()):v(e+=50)}),50);return function(){clearInterval(t),console.log("clearing interval")}}),[t]);var x=function(){var e=Object(o.a)(u.a.mark((function e(t){var n,r,a,c,s,i,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.tag,a=t.page,c=null!==(n=c=void 0===a?void 0:a)&&void 0!==n?n:Object(p.random)(r.count),s="/api/post.json?limit=1&page="+c+"&tags="+r.name,e.next=5,fetch(s);case 5:return i=e.sent,e.next=8,i.json();case 8:if(o=e.sent,!(u=o[0])||!u.file_url||"mp4"!==u.file_ext&&"webm"!==u.file_ext||!u.id){e.next=14;break}return d(c),e.abrupt("return",{url:o[0].file_url,id:o[0].id,tag:r});case 14:return e.abrupt("return",x({tag:r,page:w(c,r)}));case 15:case"end":return e.stop()}var u}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(g.jsxs)(a.a.Fragment,{children:[Object(g.jsx)(h.a,{color:S(O)<25?"secondary":"primary",variant:"determinate",value:S(O),className:"controls timer"},t.id),Object(g.jsx)("video",{muted:!0,preload:"auto",autoPlay:!0,src:null===n||void 0===n?void 0:n.url,onEnded:function(){var e=w(b,t);x({tag:t,page:e}).then((function(e){c(e)}))}})]})},C=n(160),A=n(48),E=function(e){var t=e.guess_result;return void 0===t?null:t.is_correct&&t.guess?Object(g.jsxs)("div",{id:"guess-result",className:"controls correct",children:[Object(g.jsx)("p",{children:t.guess.replaceAll("_"," ")}),t.guess!==t.correct_answer&&Object(g.jsxs)("p",{children:["(",t.correct_answer.replaceAll("_"," "),")"]}),Object(g.jsx)("h1",{children:"\ud83c\udf89 is correct \ud83c\udf8a"})]}):t.guess?Object(g.jsxs)("div",{id:"guess-result",className:"controls wrong",children:[Object(g.jsx)("p",{id:"incorrect-guess",children:t.guess.replaceAll("_"," ")}),Object(g.jsx)("h1",{children:"is incorrect"}),Object(g.jsxs)("p",{children:["It was ",t.correct_answer.replaceAll("_"," ")]})]}):Object(g.jsxs)("div",{id:"guess-result",className:"controls wrong",children:[Object(g.jsx)("h1",{children:"No guess"}),Object(g.jsxs)("p",{children:["It was ",t.correct_answer.replaceAll("_"," ")]})]})},R=function(e){var t=e.score,n=e.max_score;return Object(g.jsxs)("p",{id:"score",className:"controls",children:["Correct: ",t,"/",n]})},T=n(37),N=function(e){return new T.a([e.answer],{includeScore:!0,threshold:.1,distance:0}).search(e.guess).length>0};!function(e){e[e.GENERAL=0]="GENERAL",e[e.ARTIST=1]="ARTIST",e[e.COPYRIGHT=3]="COPYRIGHT",e[e.CHARACTER=4]="CHARACTER"}(I||(I={}));var k=4e3,F=function(e){return 100*e/k};function G(e,t){return void 0!==e&&N({guess:e,answer:t.name})}function H(){return(H=Object(o.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/tag.json?limit=0&order=count&type="+I.COPYRIGHT);case 2:return t=e.sent,e.next=5,t.json();case 5:return n=e.sent,e.abrupt("return",n.filter((function(e){return e.count>0})));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var P=[{max:1e5,min:500},{max:1e5,min:500},{max:1e5,min:500},{max:500,min:100},{max:500,min:100},{max:500,min:100},{max:500,min:100},{max:500,min:100},{max:500,min:100},{max:100,min:25},{max:100,min:25},{max:100,min:25},{max:100,min:25},{max:25,min:10},{max:25,min:10},{max:25,min:10},{max:25,min:10},{max:1,min:1}],L=function(){var e=Object(r.useState)(0),t=Object(l.a)(e,2),n=t[0],c=t[1],s=Object(r.useState)([]),i=Object(l.a)(s,2),u=i[0],o=i[1],j=Object(r.useState)(void 0),d=Object(l.a)(j,2),f=d[0],m=d[1],O=Object(r.useState)([]),v=Object(l.a)(O,2),p=v[0],_=v[1],S=Object(r.useState)([]),w=Object(l.a)(S,2),I=w[0],N=w[1],L=Object(r.useState)(!1),B=Object(l.a)(L,2),Y=B[0],D=B[1],J=Object(r.useState)(!1),M=Object(l.a)(J,2),q=M[0],z=M[1],K=Object(r.useState)(Object(A.a)()),Q=Object(l.a)(K,2),U=Q[0],V=Q[1],W=Object(r.useState)(void 0),X=Object(l.a)(W,2),Z=X[0],$=X[1],ee=Object(r.useState)(0),te=Object(l.a)(ee,2),ne=te[0],re=te[1],ae=Object(r.useState)(0),ce=Object(l.a)(ae,2),se=ce[0],ie=ce[1],ue=Object(r.useState)(void 0),oe=Object(l.a)(ue,2),le=oe[0],je=oe[1],be=Object(r.useState)(0),de=Object(l.a)(be,2),fe=de[0],me=de[1];Object(r.useEffect)((function(){var e=10;c(e);var t=setInterval((function(){e<90?c(e+=10):clearInterval(t)}),100);return function(){return H.apply(this,arguments)}().then((function(e){c(100),o(e);var t=new T.a(e,{findAllMatches:!0,keys:["name"]});m(t)})),function(){return clearInterval(t)}}),[]),Object(r.useEffect)((function(){if(le){ge(U);var e=0,t=setInterval((function(){e>=k?(je(void 0),e=0):e+=50,me(e)}),50);return function(){return clearInterval(t)}}}),[U,le]);var Oe=function(){var e=p[se];je(e),N([]),se+1<p.length?ie(se+1):ve()},ve=function(){D(!1),_([])},ge=function(e){var t=0;e.forEach((function(e,n){G(e,n)&&(t+=1)})),re(t)};return Object(g.jsxs)(a.a.Fragment,{children:[le&&Object(g.jsx)(h.a,{variant:"determinate",value:F(fe),className:"controls timer"},se),q&&Object(g.jsx)(R,{score:ne,max_score:se}),0===u.length&&Object(g.jsx)(h.a,{variant:"determinate",value:n}),!Y&&Object(g.jsx)(C.a,{variant:"contained",disabled:0===u.length,onClick:function(){var e;_((e=u,P.map((function(t){var n=t.max,r=t.min;return b()(e.filter((function(e){var t=e.count;return n>=t&&t>=r})))})))),D(!0),z(!0),V(Object(A.a)()),re(0),ie(0)},id:"start",children:"Start"}),Y&&p.length>0&&!le&&Object(g.jsx)(y,{tag:p[se],current_video:Z,set_current_video:$,play_next_tag:Oe}),le&&Object(g.jsx)(E,{guess_result:{guess:U.get(le),correct_answer:le.name,is_correct:G(U.get(le),le)}}),Y&&!le&&Object(g.jsx)(x,{on_guess_changed:function(e){var t=p[se];if(t){var n=U.set(t,e);V(n)}},on_tag_search:function(e){if(void 0!==f&&e){var t=f.search(e,{limit:20}).map((function(e){return e.item}));N(t)}else N([])},on_guess_submitted:function(){var e=p[se];U.get(e)&&Oe()},options:I})]})},B=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,165)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),r(e),a(e),c(e),s(e)}))},Y=n(162),D=n(70),J=n(161),M=n(40),q=Object(D.a)({palette:{type:"dark",primary:J.a,secondary:M.a}});s.a.render(Object(g.jsx)(a.a.StrictMode,{children:Object(g.jsx)(Y.a,{theme:q,children:Object(g.jsx)(L,{})})}),document.getElementById("root")),B()},83:function(e,t,n){}},[[118,1,2]]]);
//# sourceMappingURL=main.62c8a90b.chunk.js.map